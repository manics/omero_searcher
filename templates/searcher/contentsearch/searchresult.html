{% extends "webclient/base/base_container.html" %}
{% load i18n %}
{% load markup %}
{% load custom_tags %}
{% load wikitags %}

{% comment %}
<!--
  Copyright (C) 2011 Carnegie Mellon University.
  All rights reserved.

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU Affero General Public License as
  published by the Free Software Foundation, either version 3 of the
  License, or (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU Affero General Public License for more details.

  You should have received a copy of the GNU Affero General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
	
	This page is based on "webclient/search/search.html"
	The latest modified Date: Dec., 2011
	Author: Baek Hwan Cho @CMU
-->
{% endcomment %}

{% block link %}
    <link rel="stylesheet" href="{% url webstatic "css/container.css" %}" type="text/css" media="screen"/>
    <link rel="stylesheet" href="{% url webstatic "css/images.css" %}" type="text/css" media="screen"/>
    <link rel="stylesheet" href="{% url webstatic "css/tooltip.css" %}" type="text/css" media="screen"/>
    <link rel="stylesheet" href="{% url webstatic "css/table.css" %}" type="text/css" media="screen"/>
    
{% endblock %}

{% block jscript %}
    <script type="text/javascript" src="{% url webstatic "javascript/jquery.tooltip.js" %}"></script>
    <script type="text/javascript" src="{% url webstatic "javascript/ui/ui.core.js" %}"></script>
    <script type="text/javascript" src="{% url webstatic "javascript/ui/ui.datepicker.js" %}"></script>
    <script type="text/javascript" src="{% url webstatic "javascript/jquery.simple.tree.js" %}"></script>    
    <script type="text/javascript" src="{% url webstatic "javascript/ui/ui.draggable.js" %}"></script>
{% endblock %}

{% block script %}

    <script type="text/javascript" src="{% url webstatic "javascript/actions.js" %}"></script>
    <script type="text/javascript" src="{% url webstatic "javascript/ui/ui.selectable.js" %}"></script>
    <script type="text/javascript" src="{% url webstatic "javascript/jquery.tablesorter.js" %}"></script>
    <script type="text/javascript" src="{% url webstatic "javascript/jquery.quicksearch.js" %}"></script>
    
    <script type="text/javascript">
    	  function relevance_feedback_entireDB() {
		        var productArray = $("input[type='radio']:checked");
		        var productListQuery = "";
		        
		        var datasetID = "{% for i in param.containers.dataset_ID %}{{ i }}{% endfor %}";
		        //var datasetID = "0";
                        var featureset = "{% for i in param.containers.featureset_name %}{{ i}}{% endfor %}"; 
<!--		        var featureset = "{{ param.containers.featureset_name }}";  -->
		        var numretrieve = "{% for i in param.containers.numretreive %}{{ i}}{% endfor %}";
		        
		        if (productArray.length == 1 ) {
		        	productArray.each(function() {
		                if(this.checked) {
		                    productListQuery = this.id;
		                }
		          });
		        	var iid = productListQuery;
		        	var retvar=window.showModalDialog("/searcher/select_czt/"+iid+"", '', 'dialogWidth:400px; dialogHeight:200px');
		        	if (retvar == null){
		        		alert("you should select one image. Otherwise, you should send them to Basket first");
				        return
				      }
		        	var retvars = retvar.split("_");
		        	featureset = retvars[0];
	        		// pass them to content search
	        		var pixels = "0";
	        		var czt = retvars[1];
	        		
	        		URL = iid+'.'+pixels+'.'+czt+'/'+datasetID+'/'+featureset+'/'+ numretrieve+'/';
	    				window.location = '/searcher/contentsearch/' + URL + '';
	        	
						} else {
							alert("you should select one image. Otherwise, you should send them to Basket first");
						}
		    
				    return false;
				    
				}
				
				function getParent(el, pTagName) {
						if (el == null){
							return null;
						} else if (el.nodeType == 1 && el.tagName.toLowerCase() == pTagName.toLowerCase()){
							 return el;
						}	else {
							return getParent(el.parentNode, pTagName);
						}
				}
				
				function toggleSection(el) {
					var inp = el.parentNode;
					var inp2 = getParent(el, 'INPUT');
					var VAL = inp2.getAttribute("value");
					
					if (VAL == "+"){
						inp2.value = "-";
					} else {
						inp2.value = "+";
					}
					
					var table = getParent(inp,'TABLE');
					var len = table.rows.length;
					var tr = getParent(inp, 'tr');
					//var rowname = tr.name;
					var rowIndex = tr.rowIndex;
					var rowname = tr.getAttribute('name');
					
					for(var i = rowIndex+1; i < len;i++){
							if (table.rows[i].getAttribute('parent_row')==rowname){
								if (table.rows[i].style.display == ""){ 
									table.rows[i].style.display = "none";
									
								}	else if (table.rows[i].style.display == "none") {
									table.rows[i].style.display = "";		
													
								}
								
							}
					}

 
					
					//alert(rowname);
					return false;
				}

        $(document).ready(function() 
            {
                var h = $(window).height()-200;
                $("div#searching").css('height', h+11);
                $("div#content_details").css('height', h+31);
                $("div#metadata_details").css('height', h+31);
                

                $("#searching_again_description").tooltip({ 
                    track: true, 
                    delay: 0, 
                    showURL: false, 
                    opacity: 1, 
                    fixPNG: true, 
                    showBody: " - ", 
                    top: -15, 
                    left: 5 
                });

		            $("table#dataTable tbody").selectable({
		            	filter: 'tr',
		            	
		            	stop: function(){
		            		var l = $('tr.ui-selected', this).length;
		            		$("tr.ui-selected td input", this).each(function(){
		            		    this.checked = true;
		            		});
		            		if (l == 1) {
		            		    //$("#toolbar").html("");
		            		    $("#right_panel").show();
		                        $("#swapMeta").html('<img tabindex="0" src="{% url webstatic "images/tree/spacer.gif" %}" class="collapsed-right" id="lhid_trayhandle_icon_right">'); 
		            		    $('tr.ui-selected', this).each(function(){  
		            		        var h = $(window).height()-169;
		            		        var obj = this.id.split("-");
		            		        $("div#metadata_details").html('<iframe width="370" height="'+h+'" src="/webclient/metadata_details/'+obj[0]+'/'+obj[1]+'/" id="metadata_details" name="metadata_details"></iframe>');
		                            $('iframe#metadata_details').load();
		                        //$("#toolbar").html('<input class="button" type="image" src="{% url webstatic "images/folder_html16.png" %}" alt="New share" title="New share" onclick="makeShare();"/> <input class="button" type="image" src="{% url webstatic "images/basket16.png" %}" alt="Add to basket" title="Add to basket"  onclick="toBasket(\'image\',\' '+obj[1]+' \');"/> <input class="button" type="image" src="{% url webstatic "images/content_search16.png" %}" alt="Content Search" title="Content Search" onclick="relevance_feedback_entireDB();">');
		                        $("#toolbar").html('<input class="button" type="image" src="{% url webstatic "images/content_search16.png" %}" alt="Content Search" title="Content Search" onclick="relevance_feedback_entireDB();">');
		                        });
		            		} else {
		            		    //$("#toolbar").html('');
		            		    
		            		    $("#toolbar").html('<input class="button" type="image" src="{% url webstatic "images/folder_html16.png" %}" alt="New share" title="New share" onclick="makeShare();"/> <input class="button" type="image" src="{% url webstatic "images/basket16.png" %}" alt="Add to basket" title="Add to basket"  onclick="manyAddToBasket();"/>'); 
		            		    manyToAnnotation();
		            		}
		            	},
		            	start: function(){
		            		$("tr td input", this).each(function(){
		            			this.checked = false;
		            		});
		            	}
		            });						

		            
								$("#dataTable").tablesorter( {sortList: [[2,0]]} ); 
	
		            $("#gotobaseket").click(function() { 
		            				window.location = "{% url webindex %}" + 'basket/';

		                    return false;
		            });


		            $("#relevance_feedback_again_button").click(function() { 
		            				var url = null;
		            				url = "{% for c in param.containers.selected_imgs %}{{ c.id }}.{{ c.pid }}.{{ c.cid }}.{{ c.zid }}.{{ c.tid }}{% if not forloop.last %},{% endif %}{% endfor %}"
		            				
	            				  var negids = "{% for c in param.containers.selected_imgs_neg %}{{ c.id }}.{{ c.pid }}.{{ c.cid }}.{{ c.zid }}.{{ c.tid }}{% if not forloop.last %},{% endif %}{% endfor %}"
                    		var productArray2 = $("input[type='radio']:checked");
                    		var productListQuery = "";
                    		var productListQuery2 = "";
 
                    		// add the selected image from here
                    		if (productArray2.length	>	0	) {
                    				productArray2.each(function() {
                    						//alert(this.value);
																productListQuery +=	this.name	+	",";
														});
														url += "," + productListQuery ;
                    		}

		            				var datasetID = "{% for i in param.containers.dataset_ID %}{{ i }}{% endfor %}";
		            				url += "/"+ datasetID;

                                                        var featset = "{% for i in param.containers.featureset_name %}{{ i}}{% endfor %}";
<!--		            				var featureset = "{{ param.containers.featureset_name }}";  -->
		            				url += "/"+ featureset+"";

		            				var numretrieve = $("select[name='NumRetrieve']");
												url += "/" + numretrieve.val();

												// negative samples
												url += "/" + negids;
												// firstly from there
												if (productArray2.length	>	0	)	{
														productArray2.each(function() {
																if(this.value == "neg") {
																		//alert("neg");
																		productListQuery2 +=	this.name	+	",";
																}
														});
														if (productListQuery2 !=""){
															url += "," + productListQuery2;
														}
												}
				                window.location = '/searcher/contentsearch/' + url + ''; 
		                    return false;
		            });
        })
    </script>
{% endblock %}

{% block left %}
<style type="text/css">
table.bk_table {
	border-width: 2px;
	border-spacing: ;
	border-style: solid none solid;;
	border-color: gray;
	border-collapse: separate;
	background-color: white;
}
table.bk_table th {
	text-align: center;
	border-width: 1px;
	border-style: none none outset;;
	background-color: white;
	-moz-border-radius: ;
}
table.bk_table td {
	text-align: center;
	background-color: white;
	-moz-border-radius: ;
}
	
</style>


<div id="searching">
    <div>
    	<h1> {% trans "Search again with additional image(s)" %} 			<span id="searching_again_description" title="Search again - <small>Performs another round of search by image content. Using the previous settings (selected image(s), featureset, # retrieved images, and dataset), you can include additional images to the search query by selecting images. <br/><br/>
				For example, if you have some images that you don't like among the current result, you can add those images as negative samples and do another round of search.</small>"><img src="{% url webstatic "images/help16.png" %}" /></span></h1>
			<fieldset>
				<LEGEND><b>Content Search</b></LEGEND>
				<div class="toolbar_noborder">
					<form>
						<label for="FeaturesetName">Feature Set</label>
						<select name="FeatureSetName">
						        <script type="text/javascript">
<!--							        var featset = "{{ param.containers.featureset_name }}";   -->
<!--                                                                var featset = "{% for i in param.containers.featureset_name %}{{ i}}{% endfor %}";-->
<!--								if (featset.tolower() == 'slf33') {
								     document.write('<option value="slf33" selected>SLF33</option><option value="slf34">SLF34</option>')
								} else {
-->
								     document.write('<option value="slf33">SLF33</option><option value="slf34" selected>SLF34</option>');
								}
							</script>
						</select>
						<p>
						<label for="NumRetrieve"># retrieved images</label>
						<select name="NumRetrieve">
							<script type="text/javascript">
								var num = "{% for i in param.containers.numretreive %}{{ i}}{% endfor %}";
								if (num == 10) {
									document.write('<option value="10">10</option><option value="20">20</option><option value="100">100</option><option value="500">500</option>');
								} else if (num == 20){
									document.write('<option value="10">10</option><option value="20" selected>20</option><option value="100">100</option><option value="500">500</option>');
								} else if (num == 100){
									document.write('<option value="10">10</option><option value="20">20</option><option value="100" selected>100</option><option value="500">500</option>');
								} else if (num == 500){
									document.write('<option value="10">10</option><option value="20">20</option><option value="100">100</option><option value="500" selected>500</option>');
								} else {
									document.write('<option value="10">10</option><option value="20">20</option><option value="100">100</option><option value="500">500</option>');
								}
							</script>
						</select>
					</form>
				</div>
				<div id="search_toolbar" class="toolbar_noborder">
					<form id="searching_form">
						<!-- <a href="/webclient/relevance/?iIds={% for c in basket.imageInBasket %}{{ c.id }}{% if not forloop.last %},{% endif %}{% endfor %}">Search by image content</a>  -->
						<input id="relevance_feedback_again_button" type="button" value="Search by image content" style="background-color:lightgreen"/> 
					</form>
				</div>
			</fieldset>
		</div>
		
		<div class="clear"></div>
    <div id="search_toolbar" class="toolbar_noborder"></div>
    	
    <div>
    	<h1>{% trans "Query configuration" %}</h1>
    	
    	<fieldset>
    		
    		<div>
	    		<h4>{% trans "Selected featureset and dataset" %}</h4>
	    		<table class="bk_table">
						<thead> 
		          <tr> 
		              <th width=50%>{% trans "Featureset name" %}</th> 
		              <th width=50%>{% trans "Dataset ID" %}</th> 
		          </tr> 
		        </thead>
		        <tbody>
					   			<tr>
										 <td width=50% >
										 		{{param.containers.featureset_name}}
										 </td>
										 <td width=50% >
										 	<script type="text/javascript">
											var did = "{% for i in param.containers.dataset_ID %}{{ i}}{% endfor %}";
											if (did == 0) {
												document.write('Entire DB');
											} else {
												var t = did;
												document.write(t);
											}
											</script>
										 </td>
									</tr>
				   		</tbody>
	    		</table>
				</div>
	
	    	<div class="clear"></div>
			
				<div>
					<h4>{% trans "Selected image(s)" %}</h4>
					<div>
				   	<table class="bk_table">
				   		<thead> 
			          <tr> 
			              <th width=20%>{% trans "Image" %}</th> 
			              <th width=20%>{% trans "ID.p.c.z.t" %}</th> 
			              <th width=50%>{% trans "Name" %}</th> 
			              <th width=10%>{% trans "Type" %}</th>
			          </tr> 
			        </thead>
				   		<tbody>
				   			{% for i in param.containers.selected_imgs_pos %}
					   			<tr>
										 <td width=20% >
										 		<img id="{{ i.id }}" src="{% url render_thumbnail_resize 32 i.id  %}" alt="image" title="{{ i.name }}"/>
										 </td>
										 <td width=20% >
										 	{{ i.id }}.{{ i.pid }}.{{ i.cid }}.{{ i.zid }}.{{ i.tid }}
										 </td>
										 <td width=50% style="overflow:hidden"> 
										 	{{ i.name }}
										 </td>
										 <td width=10%>{% trans "+" %}</td>
									</tr>
				   			{% endfor %}
				   			{% for i in param.containers.selected_imgs_neg %}
					   			<tr  align="center">
										 <td width=20% >
										 		<img id="{{ i.id }}" src="{% url render_thumbnail_resize 32 i.id  %}" alt="image" title="{{ i.name }}"/>
										 </td>
										 <td width=20% >
										 	{{ i.id }}.{{ i.pid }}.{{ i.cid }}.{{ i.zid }}.{{ i.tid }}
										 </td>
										 <td width=50% style="overflow:hidden"> 
										 	{{ i.name }}
										 </td>
										 <td width=10% align="center">{% trans "-" %}</td>
										 
									</tr>
				   			{% endfor %}
				   		</tbody>	
				  	</table>	
				  </div>
			  </div>		  	
			</fieldset>
  	</div>
		
		<div class="clear"></div>
		<div id="search_toolbar" class="toolbar_noborder"></div>
		
		<div>	
			<h1> {% trans "Go to Basket" %}</h1>
			<form id="form_basket">
				<!-- <a href="/webclient/relevance/?iIds={% for c in basket.imageInBasket %}{{ c.id }}{% if not forloop.last %},{% endif %}{% endfor %}">Search by image content</a>  -->
				<input id="gotobaseket" type="button" style="background-color:lightgreen" value="BASKET"/> 
			</form>
  	</div>
	

</div>

{% endblock %}

{% block center %}

<div id="content_details"> 
		<div>
    		<h1>{% trans "Search results using image content" %}</h1>
        <!-- <p>{% trans "This is search results using image content" %}</p> -->
    </div>
    <div class="clear"></div>
		
		<div id="toolbar" class="toolbar_noborder"></div>
    <div class="clear"> </div>
    
    <div>
        {% if manager.c_size %}
       
        <table id="dataTable" class="tablesorter" >
            <thead> 
                <tr>
                		<th width=6%></th> 
                    <th width=10% class="desc">{% trans "Image" %}</th> 
                    <th width=7% class="desc">{% trans "Rank" %}</th> 
                    <th width=20% class="desc" style="overflow:hidden">{% trans "Server" %}</th> 
                    <th width=7% class="desc" style="overflow:hidden">{% trans "Owner" %}</th> 
              			<th width=20% class="desc" style="overflow:hidden">{% trans "ID.p.c.z.t" %}</th> 
              			<th width=20% class="desc" style="overflow:hidden">{% trans "Name" %}</th>
              			<th width=5% class="desc">{% trans "Neg" %}</th> 
                    <th width=5% class="desc">{% trans "Pos" %}</th> 
                </tr> 
            </thead>
            <tbody>
            	<script type="text/javascript">
								var rows_toggle = new Array();
								var rows_plus = new Array();
								var rows_plus_id = new Array();
								var toggle_count = 0;
								var plus_count = 0;
								var current_rank = "";
								var row_name = "";
								
								var previous_id = "-2";
								var current_id = "-1";
								var previous_rank ="";
								var current_row_name ="";
								var previous_row_name ="";
								
								{% for c in manager.containers.images %}
								current_id = "{{ c.id }}";
								current_rank =  "{{ c.rank }}";
								current_row_name = current_rank+ "-"+ current_id;
								if (current_id == previous_id) {
									// this row should be toggled
									rows_toggle[toggle_count] = current_row_name;
									//alert("toggle: "+rows_toggle[toggle_count]);
									
									
									// previous row should be the plus if it accepts some criteria
									if (plus_count == 0){	// when there is no previous plus row
										rows_plus[plus_count] = previous_row_name;
										rows_plus_id[plus_count] = previous_id;
										//alert("plus: "+rows_plus[plus_count]);
										plus_count++;
										
									} else {
										if (!(rows_plus_id[plus_count-1] == current_id)) {
											rows_plus[plus_count] = previous_row_name;
											rows_plus_id[plus_count] = previous_id;
											//alert("plus: "+rows_plus[plus_count]);
											plus_count++;
											
										}
									}
									toggle_count++;
									
								} else {
									// this row should not be toggled
									// if next one is toggled-row, then this should be plus one
								}
								
								previous_id = current_id;
								previous_rank = current_rank;
								previous_row_name = current_row_name;
								
								{% endfor %}
								
								
								
								previous_id = "-2";
								current_id = "-1";
								current_rank = "";
								row_name = "";
								var hidden_count = 0;
								//var rows_toggle = new Array();
								
								var flag_toggle = false;
								var flag_plus = false;
								plus_count = 0;
								var parent_row_name ="";
								
								
								{% for c in manager.containers.images %}
								current_id = "{{ c.id }}";
								current_rank =  "{{ c.rank }}";
								row_name = current_rank+ "-"+ current_id;
								
								for(var i=0;i<rows_toggle.length;i++){
									if (row_name == rows_toggle[i]) {
										flag_toggle = true;
										//alert("toggle");
									}
								}
								for(i=0;i<rows_plus.length;i++){
									if (row_name == rows_plus[i]) {
										flag_plus = true; 
										parent_row_name = rows_plus[plus_count];
										plus_count++;
									}
								}
								
								if (flag_toggle){
										//alert("goggle:"+row_name+" parent_row:"+ parent_row_name);
										document.write('\
											<tr id="image-{{ c.id }}" name="'+row_name+'" style="display:none" parent_row="'+parent_row_name+'" BGCOLOR="#99CCFF">\
												<td/>\
												<td class="desc" >\
		                        <img id="{{ c.id }}" src="{% url render_thumbnail_resize 32 c.id  %}" alt="image" title="{{ c.name }}"/>\
		                        <input type="checkbox" name="image" id="{{ c.id }}" class="hide">\
		                    </td>\
		                    <td class="desc"  >{{ c.rank }}</td> \
		                    <td class="desc" style="overflow:hidden">{{ c.server_name|truncateafter:"20" }}</td>\
		                    <td class="desc" style="overflow:hidden">{{ c.owner_ome_name|truncateafter:"15" }}</td>\
		                    <td class="desc" >{{ c.id }}.{{ c.pid }}.{{ c.cid }}.{{ c.zid }}.{{ c.tid }}</td>\
		                    <td class="desc" style="overflow:hidden">{{ c.name|truncateafter:"20" }}</td>\
										    <td width=10% class="desc"> <input type="radio" name="{{ c.id }}.{{ c.pid }}.{{ c.cid }}.{{ c.zid }}.{{ c.tid }}" id="{{ c.id }}" value="neg"> </td> \
		                    <td width=10% class="desc"> <input type="radio" name="{{ c.id }}.{{ c.pid }}.{{ c.cid }}.{{ c.zid }}.{{ c.tid }}" id="{{ c.id }}" value="pos"> </td> \
		                	</tr>');
	              } else if (flag_plus) {
	              		document.write('\
											<tr id="image-{{ c.id }}" name="'+row_name+'">\
												<td><input type="BUTTON" style="border:0px; font: bold 14px Arial" value="+"  ONCLICK="toggleSection(this); return false;"></td>\
												<td class="desc">\
		                        <img id="{{ c.id }}" src="{% url render_thumbnail_resize 32 c.id  %}" alt="image" title="{{ c.name }}"/>\
		                        <input type="checkbox" name="image" id="{{ c.id }}" class="hide">\
		                    </td>\
		                    <td class="desc">{{ c.rank }}</td> \
		                    <td class="desc" style="overflow:hidden">{{ c.server_name|truncateafter:"20" }}</td>\
		                    <td class="desc" style="overflow:hidden">{{ c.owner_ome_name|truncateafter:"15" }}</td>\
		                    <td class="desc" style="overflow:hidden">{{ c.id }}.{{ c.pid }}.{{ c.cid }}.{{ c.zid }}.{{ c.tid }}</td>\
		                    <td class="desc" style="overflow:hidden">{{ c.name|truncateafter:"20" }}</td>\
										    <td width=10% class="desc"> <input type="radio" name="{{ c.id }}.{{ c.pid }}.{{ c.cid }}.{{ c.zid }}.{{ c.tid }}" id="{{ c.id }}" value="neg"> </td> \
		                    <td width=10% class="desc"> <input type="radio" name="{{ c.id }}.{{ c.pid }}.{{ c.cid }}.{{ c.zid }}.{{ c.tid }}" id="{{ c.id }}" value="pos"> </td> \
		                	</tr>');
	              } else {
	              		document.write('\
											<tr id="image-{{ c.id }}" name="'+row_name+'">\
												<td></td>\
												<td class="action">\
		                        <img id="{{ c.id }}" src="{% url render_thumbnail_resize 32 c.id  %}" alt="image" title="{{ c.name }}"/>\
		                        <input type="checkbox" name="image" id="{{ c.id }}" class="hide">\
		                    </td>\
		                    <td class="desc">{{ c.rank }}</td> \
		                    <td class="action" style="overflow:hidden">{{ c.server_name|truncateafter:"20" }}</td>\
		                    <td class="desc" style="overflow:hidden">{{ c.owner_ome_name|truncateafter:"15" }}</td>\
		                    <td  class="desc" style="overflow:hidden">{{ c.id }}.{{ c.pid }}.{{ c.cid }}.{{ c.zid }}.{{ c.tid }}</td>\
		                    <td class="desc" style="overflow:hidden">{{ c.name|truncateafter:"20" }}</td>\
										    <td width=10% class="desc"> <input type="radio" name="{{ c.id }}.{{ c.pid }}.{{ c.cid }}.{{ c.zid }}.{{ c.tid }}" id="{{ c.id }}" value="neg"> </td> \
		                    <td width=10% class="desc"> <input type="radio" name="{{ c.id }}.{{ c.pid }}.{{ c.cid }}.{{ c.zid }}.{{ c.tid }}" id="{{ c.id }}" value="pos"> </td> \
		                	</tr>');
	              }
									
								flag_toggle = false;
								flag_plus = false;
								

								{% endfor %}
								
								//toggle(rows_toggle);
								//toggle2();
								//alert('haha');
							</script>	

            </tbody>
        </table>
        
        {% else %}
            <script type="text/javascript">
	            var txt="";
	            var i=0;
	            {% for c in manager.errorMsg %}
	            	txt += '<p>'+"{{ c }}"+'</p>';
	            	i+=1;
	            {% endfor %}
	            document.write(txt);
            </script>
        {% endif %}

    </div>	
	
</div>

{% endblock %}


{% block right %}

<div id="metadata_details" style="overflow: auto;"> </div>

{% endblock %}
